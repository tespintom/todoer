<section class="todoapp">
  <header class="header">
    <h1>todos</h1>
  </header>

  <section class="main">
    <ul class="todo-list">

    </ul>

  </section>
</section>

<script>
$(function() {
  // The takshtml method takes in a JS representation
  // of the task and produces an HTML representation useing
  // <li> tags
  function taskHtml(task) {
    var checkedStatus = task.done ? "checked" : "";
    var liElement = '<li><div class="view"><input class="toggle" type="checkbox"' +
    " data-id='" + task.id + "'" +
    checkedStatus +
    '><label>' +
     task.title +
     '</label></div></li>';

    return liElement;
  }

  // toggleTask takes in an HTML representation of
  // an event that fires from tn html representation of
  // the toggle checkoubox and performs an api requres to toggle
  // the value of the 'done' field
  function toggleTask(e) {
    var itemId = $(e.target).data("id");

    var doneValue = Boolean($(e.target).is(':checked'));

    $.post("/tasks/" + itemId, {
      _method: "PUT",
      task: {
        done: doneValue
      }
    });
  }
  $.get("/tasks").success( function( data ) {
    var htmlString = "";

    $.each(data, function(index,  task) {

      htmlString += taskHtml(task);
    });
    var ulTodos = $('.todo-list');
    ulTodos.html(htmlString);

    $('.toggle').change(toggleTask);


  });
});
</script>
